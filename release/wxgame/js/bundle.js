var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(){function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return t}()({1:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var o=t("./script/Beings"),i=(r(o),t("./script/Bullet")),a=(r(i),t("./script/Hero")),s=(r(a),t("./script/Monster")),u=(r(s),t("./script/Thing")),l=(r(u),t("./script/Hero_Bullet")),c=(r(l),t("./script/Monster_Bullet")),h=(r(c),t("./script/Gate")),f=(r(h),t("./script/Wall")),p=(r(f),t("./script/Screen")),_=r(p),y=t("./script/DragPoint"),d=(r(y),t("./script/Wheel")),v=(r(d),t("./script/Monster_Bullet_huge")),b=(r(v),t("./script/Monster_Bullet_normal")),g=(r(b),t("./script/Goblin")),m=(r(g),Laya.Browser),w=Laya.WebGL,O=Laya.Stage,k=Laya.Stat;Laya.Handler;Laya.init(m.clientWidth,m.clientHeight,w),Laya.stage.screenMode="horizontal",Laya.stage.scaleMode=O.SCALE_SHOWALL,Laya.stage.bgColor="#232628";var P=m.clientWidth,j=m.clientHeight;Laya.stage.alignV=O.ALIGN_MIDDLE,Laya.stage.alignH=O.ALIGN_CENTER,k.show(),window.the_screen=new _["default"](P,j),window.Monster_list=[],window.Bullet_list=[],window.Wall_list=[],window.Thing_list=[]},{"./script/Beings":2,"./script/Bullet":3,"./script/DragPoint":4,"./script/Gate":5,"./script/Goblin":6,"./script/Hero":10,"./script/Hero_Bullet":11,"./script/Monster":13,"./script/Monster_Bullet":14,"./script/Monster_Bullet_huge":15,"./script/Monster_Bullet_normal":16,"./script/Screen":17,"./script/Thing":18,"./script/Wall":19,"./script/Wheel":20}],2:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.HP=1,t.mapX=100,t.mapY=100,t.Type="Beings",t.width=50,t.height=50,t.v_max=5,t.direction_x=1,t.direction_y=1,t.m=.01,t}return i(e,t),a(e,[{key:"root_reset",value:function(){Laya.stage.addChild(this),this.pivot(this.width/2,this.height/2),console.log("root_reset!"),this.branch_reset()}},{key:"up_date",value:function(){this.x=this.mapX-the_Hero.mapX+Laya.Browser.clientWidth/2,this.y=this.mapY-the_Hero.mapY+Laya.Browser.clientHeight/2,this.HP<1?this.dead_action():(this.visible=!0,this.action())}},{key:"dead_action",value:function(){this.visible=!1,Laya.stage.removeChild(this),Laya.Pool.recover(this.Type,this),this.dead()}},{key:"get_harm",value:function(t){this.HP-=t}},{key:"dead",value:function(){}},{key:"action",value:function(){console.log("Beings action")}},{key:"dl",value:function(t,e){return Math.sqrt(t*t+e*e)}},{key:"Object_dl",value:function(t){return Math.sqrt(t.dx*t.dx+t.dy*t.dy)}},{key:"get_distance",value:function(t){var e=this.mapX-t.mapX,n=this.mapY-t.mapY;return this.dl(e,n)}},{key:"get_vector_v",value:function(t,e,n){var r=this.dl(e,n);return r>1e-6&&t>1e-6?{vx:e*t/r,vy:n*t/r}:{vx:0,vy:0}}},{key:"getURLs",value:function(t,e){for(var n=[],r=0;e>r;r+=1)n.push("res/atlas/"+t+r+".png");return n}},{key:"getDir",value:function(t,e,n){return t>0?"right":-t>0?"left":n}},{key:"reachable",value:function(t,e){var n=[];n.push({x:t+this.width/2,y:e+this.height/2}),n.push({x:t,y:e+this.height/2}),n.push({x:t-this.width/2,y:e+this.height/2}),n.push({x:t-this.width/2,y:e}),n.push({x:t-this.width/2,y:e-this.height/2}),n.push({x:t,y:e-this.height/2}),n.push({x:t+this.width/2,y:e-this.height/2}),n.push({x:t+this.width/2,y:e});var r=!0,o=!0,i=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value;r&=the_screen.getPass(l.x,l.y)}}catch(c){i=!0,a=c}finally{try{!o&&u["return"]&&u["return"]()}finally{if(i)throw a}}return r}},{key:"move_by_dx_dy",value:function(t,e){t>30&&(t=30),e>30&&(e=30),this.reachable(this.mapX+t,this.mapY)?this.mapX+=t:this.reachable(this.mapX+t/2,this.mapY)&&(this.mapX+=t/2),this.reachable(this.mapX,this.mapY+e)?this.mapY+=e:this.reachable(this.mapX,this.mapY+e/2)&&(this.mapY+=e/2)}}]),e}(Laya.Sprite);n["default"]=s},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings.js"),l=r(u),c=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.vx=1,t.vy=1,t.v_max=10,t.m=.01,t}return a(e,t),s(e,[{key:"action",value:function(){var t=this.hit_wall(this.vx,this.vy);this.HP-=1,this.move_by_dx_dy(this.vx,this.vy);var e=this.get_attack_list();this.explosion(e),t&&(this.HP=-1)}},{key:"dead",value:function(){console.log("before: "+Bullet_list.length),Bullet_list.splice(Bullet_list.indexOf(this),1),console.log("after: "+Bullet_list.length)}},{key:"get_attack_list",value:function(){}},{key:"explosion",value:function(t){if(t.length>0){this.HP=-1;var e=!0,n=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;this.attack(a)}}catch(s){n=!0,r=s}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}}}},{key:"attack",value:function(t){console.log("Bullet attack")}},{key:"branch_reset",value:function(){console.log("branch_reset 123!"),Bullet_list.push(this),this.branch_Hero_or_Monster_reset()}},{key:"hit_wall",value:function(t,e){return!this.reachable(this.mapX+t,this.mapY+e)}}]),e}(l["default"]);n["default"]=c},{"./Beings.js":2}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(t){function e(t,n,i){r(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return Laya.stage.addChild(a),a.size(2*i,2*i),a.pivot(i,i),a.graphics.drawCircle(i,i,i,"#FFFF00"),a.pos(t,n),a.alpha=.2,a.r=i,a.mouseThrough=!0,a}return i(e,t),e}(Laya.Sprite);n["default"]=a},{}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Thing"),l=r(u),c=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.sentence="是否去往下一层？",t}return a(e,t),s(e,[{key:"use_it",value:function(){}}]),e}(l["default"]);n["default"]=c},{"./Thing":18}],6:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster"),l=r(u),c=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Goblin",t.width=400,t.height=400,t.loadImage("./orz.jpg").scale(.4,.4),t}return a(e,t),s(e,[{key:"skill",value:function(){}},{key:"leaf_reset",value:function(){this.HP=20}}]),e}(l["default"]);n["default"]=c},{"./Monster":13}],7:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=t("./Hero_Bullet_normal"),h=r(c),f=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.first_waiting=10,t.second_waiting=100,t.bullet=h["default"],t.bullet_type="Hero_Bullet_normal",t}return a(e,t),s(e,[{key:"action",value:function(){}},{key:"dead",value:function(){}},{key:"shoot",value:function(){var t=Laya.Pool.getItemByClass(this.bullet_type,this.bullet);t.root_reset(),console.log("shoot!")}},{key:"branch_reset",value:function(){console.log("branch_reset!"),this.leaf_reset()}}]),e}(l["default"]);n["default"]=f},{"./Beings":2,"./Hero_Bullet_normal":12}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=(r(u),t("./Hero_Bullet_normal")),c=r(l),h=t("./Gun"),f=r(h),p=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.first_waiting=2,t.second_waiting=10,t.loadImage("res/guns/gun0.png"),Laya.stage.addChild(t),t.size(64,32),t.w=64,t.h=32,t.pos(Laya.Browser.clientWidth/2,Laya.Browser.clientHeight/2),t.bullet=c["default"],t.bullet_type="Hero_Bullet_normal",t}return a(e,t),s(e,[{key:"leaf_reset",value:function(){this.pivot(8,16)}}]),e}(f["default"]);n["default"]=p},{"./Beings":2,"./Gun":7,"./Hero_Bullet_normal":12}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster"),l=r(u),c=t("./Monster_Bullet_normal"),h=r(c),f=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Gunner",t.width=100,t.height=100,t.range=400,t.v_max=3,t.loadImage("orz.jpg"),t}return a(e,t),s(e,[{key:"skill",value:function(){var t=Laya.Pool.getItemByClass("Monster_Bullet_normal",h["default"]);t.root_reset(),t.init(this),console.log("shoot!")}},{key:"leaf_reset",value:function(){this.HP=100}}]),e}(l["default"]);n["default"]=f},{"./Monster":13,"./Monster_Bullet_normal":16}],10:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=t("./Bullet"),h=(r(c),t("./Monster")),f=(r(h),t("./Hero_Bullet_normal")),p=(r(f),t("./Gun_normal")),_=r(p),y=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.v_max=5,t.HP_max=100,t.HP=100,t.armor_max=10,t.armot=10,t.shoot_power=0,t.size(32,48),Laya.Animation.createFrames(t.getURLs("hero/left",4),"hero_left"),Laya.Animation.createFrames(t.getURLs("hero/right",4),"hero_right"),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t}return a(e,t),s(e,[{key:"action",value:function(){var t=the_screen.getVelosity().x,e=the_screen.getVelosity().y,n=this.dl(t,e);this.move_by_dx_dy(t*this.v_max,e*this.v_max),the_screen.getShoot()?this.shoot_power+=1:0!=this.shoot_power&&(this.shoot_power+=1),this.shoot_power>=this.main_gun.first_waiting&&(this.shoot_event(),this.shoot_power=-this.main_gun.second_waiting);var r=this.get_nearest_monster_orientation();this.Object_dl(r)>1e-6?(this.direction_x=r.dx,this.direction_y=r.dy):n>1e-6&&(this.direction_x=t,this.direction_y=e);var o=this.getDir(this.direction_x,this.direction_y,this.pre_dir);if(this.ani.pos(this.x,this.y),o!=this.pre_dir&&(this.ani.play(0,!0,"hero_"+o),this.pre_dir=o),this.direction_x>=0){this.main_gun.scaleX=1;var i=90-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=i}else{this.main_gun.scaleX=-1;var a=270-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=a}}},{key:"shoot_event",value:function(){this.main_gun.shoot(),this.shooting_sound()}},{key:"shooting_sound",value:function(){console.log("播放音效"),Laya.SoundManager.playSound("res/sounds/shooting.mp3",1,new Laya.Handler(this,this.onComplete))}},{key:"get_nearest_monster_orientation",value:function(){var t=1e6,e=null,n=!0,r=!1,o=void 0;try{for(var i,a=Monster_list[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,o=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw o}}return null!==e?{dx:e.mapX-this.mapX,dy:e.mapY-this.mapY}:{dx:0,dy:0}}},{key:"get_harm",value:function(t){this.armor>=t?this.armor-=t:(this.armor=0,t-=this.armor,this.HP-=t)}},{key:"dead",value:function(){this.ani.visible=!1,Laya.stage.removeChild(this.ani)}},{key:"branch_reset",value:function(){this.HP=this.HP_max,this.armor=this.armor_max,Laya.stage.addChild(this.ani),this.ani.pos(this.x,this.y),this.ani.index=1,this.ani.play(0,!0,"hero_right"),this.main_gun=new Laya.Pool.getItemByClass("Gun_normal",_["default"]),this.main_gun.root_reset(),this.alternate_gun=null,this.pre_dir="right"}}]),e}(l["default"]);n["default"]=y},{"./Beings":2,"./Bullet":3,"./Gun_normal":8,"./Hero_Bullet_normal":12,"./Monster":13}],11:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Bullet"),l=r(u),c=t("./Monster"),h=(r(c),function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return a(e,t),s(e,[{key:"get_attack_list",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var o,i=Monster_list[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;this.attackable(a)&&t.push(a)}}catch(s){n=!0,r=s}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}var u=!0,l=!1,c=void 0;try{for(var h,f=Wall_list[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;this.attackable(p)&&t.push(p)}}catch(s){l=!0,c=s}finally{try{!u&&f["return"]&&f["return"]()}finally{if(l)throw c}}return t}},{key:"attackable",value:function(t){}},{key:"branch_Hero_or_Monster_reset",value:function(){var t=this.get_vector_v(this.v_max,the_Hero.direction_x,the_Hero.direction_y);this.vx=t.vx,this.vy=t.vy,this.mapX=the_Hero.mapX,this.mapY=the_Hero.mapY,this.leaf_reset()}}]),e}(l["default"]));n["default"]=h},{"./Bullet":3,"./Monster":13}],12:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Hero_Bullet"),l=r(u),c=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.v_max=5,r.Type="Hero_Bullet_normal",r.r=20,r.size(2*r.r,2*r.r),r.graphics.drawCircle(r.r,r.r,r.r,"#FFFF00"),r.filters=[new Laya.GlowFilter("#FFFFFF",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<40}},{key:"attack",value:function(t){console.log("Hero_Bullet_normal attack"),t.get_harm(20)}},{key:"leaf_reset",value:function(){this.HP=50,this.rotation=-Math.atan2(the_Hero.direction_x,the_Hero.direction_y)/Math.PI*180,this.filters=[new Laya.GlowFilter("#FFFFFF",5,0,0)]}}]),e}(l["default"]);n["default"]=c},{"./Hero_Bullet":11}],13:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.skill_power=1e3,t.skill_cost=360,t.shooter=!0,t.range=1e3,t}return a(e,t),s(e,[{key:"action",value:function(){this.direction_x=this.get_hero_orientation().dx,this.direction_y=this.get_hero_orientation().dy,this.wandering(),this.skill_power<1e3&&(this.skill_power+=1),this.skill_power>=this.skill_cost&&(this.skill_power=0,this.skill())}},{key:"force",value:function(t){var e=this.mapX-t.mapX,n=this.mapY-t.mapY,r=0,o=0;return Math.abs(e)>.01&&(r=1/e),Math.abs(n)>.01&&(o=1/n),{fx:r,fy:o}}},{key:"wandering",value:function(){console.log(Monster_list.length);var t={vx:0,vy:0};this.shooter&&(this.get_distance(the_Hero)>this.range/1.5?t=this.get_vector_v(this.v_max,this.direction_x,this.direction_y):this.get_distance(the_Hero)<this.range/2&&(t=this.get_vector_v(this.v_max,-this.direction_x,-this.direction_y)));var e={fx:0,fy:0},n=!0,r=!1,o=void 0;try{for(var i,a=Monster_list[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(this!==s){var u=this.force(s);e.fx+=u.fx,e.fy+=u.fy}}}catch(l){r=!0,o=l}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw o}}Monster_list.length>1&&(e.fx/=Monster_list.length-1,e.fy/=Monster_list.length-1),this.move_by_dx_dy(t.vx+e.fx/this.m,t.vy+e.fx/this.m)}},{key:"dead",value:function(){Monster_list.splice(Monster_list.indexOf(this),1)}},{key:"branch_reset",value:function(){console.log("branch_reset!"),Monster_list.push(this),this.leaf_reset()}},{key:"get_hero_orientation",value:function(){return{dx:the_Hero.mapX-this.mapX,dy:the_Hero.mapY-this.mapY}}}]),e}(l["default"]);n["default"]=c},{"./Beings":2}],14:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Bullet"),l=r(u),c=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return a(e,t),s(e,[{key:"get_attack_list",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var o,i=Wall_list[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;this.attackable(a)&&t.push(a)}}catch(s){n=!0,r=s}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}return this.attackable(the_Hero)&&t.push(the_Hero),t}},{key:"attackable",value:function(t){}},{key:"attack",value:function(t){console.log("Monster_Bullet attack")}},{key:"branch_Hero_or_Monster_reset",value:function(){this.leaf_reset()}},{key:"init",value:function(t){var e=this.get_vector_v(this.v_max,t.direction_x,t.direction_y);this.vx=e.vx,this.vy=e.vy,this.mapX=t.mapX,this.mapY=t.mapY}}]),e}(l["default"]);n["default"]=c},{"./Bullet":3}],15:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster_Bullet"),l=r(u),c=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.Type="Monster_Bullet_huge",r.vx=t,r.vy=n,r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<40}},{key:"attack",value:function(t){console.log("Monster_Bullet_huge attack"),t.get_harm(20)}},{key:"leaf_reset",value:function(){this.HP=40,console.log("this.HP = ",this.HP)}}]),e}(l["default"]);n["default"]=c},{"./Monster_Bullet":14}],16:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster_Bullet"),l=r(u),c=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.Type="Monster_Bullet_normal",r.vx=t,r.vy=n,r.r=20,r.graphics.drawCircle(0,0,r.r,"#FFFF00"),r.filters=[new Laya.GlowFilter("#FFFFFF",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<20}},{key:"attack",value:function(t){console.log("Monster_Bullet_normal attack"),t.get_harm(10)}},{key:"leaf_reset",value:function(){this.HP=40,console.log("this.HP = ",this.HP)}}]),e}(l["default"]);n["default"]=c},{"./Monster_Bullet":14}],17:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./DragPoint"),l=(r(u),t("./Wheel")),c=r(l),h=t("./hero"),f=r(h),p=t("./Goblin"),_=(r(p),t("./Gunner")),y=r(_),d=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return r.width=r.width,r.height=n,Laya.stage.addChild(r),r.size(t,n),r.pos(0,0),r.loadMap(),r.time_count=0,r.time_interval=800,r}return a(e,t),s(e,[{key:"loadMap",value:function(){var t=Laya.TiledMap,e=Laya.Rectangle,n=Laya.Handler,r=(Laya.Event,
Laya.Browser);this.tiledMap=new t,this.tiledMap.createMap("res/tiledmaps/00.json",new e(0,0,r.width,r.height),n.create(this,this.onLoadedMap))}},{key:"onLoadedMap",value:function(){console.log("ok");var t=Laya.Event;Laya.stage.on(t.MOUSE_UP,this,this.onMouseUp),Laya.stage.on(t.MOUSE_MOVE,this,this.onMouseMove),Laya.stage.on(t.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(t.MOUSE_OUT,this,this.onMouseUP),this.whl=new c["default"](this.width/4,3*this.height/4,this.width/15,!0),this.atk=new c["default"](3*this.width/4,3*this.height/4,this.width/15),this.atk.alpha=.8,window.the_Hero=Laya.Pool.getItemByClass("Hero",f["default"]),the_Hero.root_reset(),Laya.timer.frameLoop(1,this,this.onFrame)}},{key:"generate_monster",value:function(){var t=Laya.Pool.getItemByClass("Gunner",y["default"]);t.root_reset(),t.mapX=500,t.mapY=500;var e=Laya.Pool.getItemByClass("Gunner",y["default"]);e.root_reset(),e.mapX=400,e.mapY=500;var n=Laya.Pool.getItemByClass("Gunner",y["default"]);n.root_reset(),n.mapX=500,n.mapY=400}},{key:"onFrame",value:function(){this.time_count%this.time_interval==0&&(this.generate_monster(),this.time_interval>20&&(this.time_interval-=20)),this.time_count+=1;var t=!0,e=!1,n=void 0;try{for(var r,o=Monster_list[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.up_date()}}catch(a){e=!0,n=a}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw n}}var s=!0,u=!1,l=void 0;try{for(var c,h=Bullet_list[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var f=c.value;f.up_date()}}catch(a){u=!0,l=a}finally{try{!s&&h["return"]&&h["return"]()}finally{if(u)throw l}}var p=!0,_=!1,y=void 0;try{for(var d,v=Wall_list[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var b=d.value;b.up_date()}}catch(a){_=!0,y=a}finally{try{!p&&v["return"]&&v["return"]()}finally{if(_)throw y}}var g=!0,m=!1,w=void 0;try{for(var O,k=Thing_list[Symbol.iterator]();!(g=(O=k.next()).done);g=!0){var P=O.value;P.up_date()}}catch(a){m=!0,w=a}finally{try{!g&&k["return"]&&k["return"]()}finally{if(m)throw w}}the_Hero.up_date(),the_Hero.pos(Laya.Browser.clientWidth/2,Laya.Browser.clientHeight/2),this.tiledMap.changeViewPort(the_Hero.mapX-Laya.Browser.clientWidth/2,the_Hero.mapY-Laya.Browser.clientHeight/2,Laya.Browser.clientWidth,Laya.Browser.clientHeight)}},{key:"onMouseDown",value:function(t){(this.whl.x-t.stageX)*(this.whl.x-t.stageX)+(this.whl.y-t.stageY)*(this.whl.y-t.stageY)<=this.whl.r*this.whl.r?this.whl.onStartDrag(t):(this.atk.x-t.stageX)*(this.atk.x-t.stageX)+(this.atk.y-t.stageY)*(this.atk.y-t.stageY)<=this.atk.r*this.atk.r&&this.atk.onStartDrag(t)}},{key:"onMouseUp",value:function(t){this.whl.ID==t.touchId?this.whl.onStopDrag():this.atk.ID==t.touchId&&this.atk.onStopDrag()}},{key:"onMouseMove",value:function(t){this.whl.ID==t.touchId?this.whl.moveTo(t.stageX,t.stageY):this.atk.ID==t.touchId&&this.atk.moveTo(t.stageX,t.stageY)}},{key:"getVelosity",value:function(){return{x:(this.whl.sp.x-this.whl.x)/this.whl.r,y:(this.whl.sp.y-this.whl.y)/this.whl.r}}},{key:"getShoot",value:function(){return null!==this.atk.ID}},{key:"getPass",value:function(t,e){var n=this.tiledMap.getLayerByIndex(0).getTileData(Math.floor(t/32),Math.floor(e/32));void 0===this.tiledMap._jsonData.tilesets[0].tiles[n-1]&&console.log(Math.floor(t/32)+","+Math.floor(e/32)+"!!!"+n);var r=this.tiledMap._jsonData.tilesets[0].tiles[n-1].properties[0].value;return r}}]),e}(Laya.Sprite);n["default"]=d},{"./DragPoint":4,"./Goblin":6,"./Gunner":9,"./Wheel":20,"./hero":21}],18:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.sentence="还没有设置句子！",t}return a(e,t),s(e,[{key:"action",value:function(){player_is_nearby()?(this.set_sentence(),this.click_the_thing()&&this.use_it()):this.hide_sentence()}},{key:"dead",value:function(){Thing_list.splice(Bullet_list.indexOf(this))}},{key:"set_sentence",value:function(){}},{key:"hide_sentence",value:function(){}},{key:"player_is_nearby",value:function(){return!1}},{key:"click_the_thing",value:function(){}},{key:"use_it",value:function(){}},{key:"branch_reset",value:function(){console.log("branch_reset!"),Thing_list.push(this),this.leaf_reset()}}]),e}(l["default"]);n["default"]=c},{"./Beings":2}],19:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=function(t){function e(t,n,r,a){o(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s.Type="Wall",s.x1=t,s.x2=n,s.y1=r,s.y2=a,s}return a(e,t),s(e,[{key:"action",value:function(){}},{key:"dead",value:function(){}},{key:"leaf_reset",value:function(){this.HP=30}}]),e}(l["default"]);n["default"]=c},{"./Beings":2}],20:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./DragPoint"),l=r(u),c=function(t){function e(t,n,r,a){o(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return Laya.stage.addChild(s),s.size(2*r,2*r),s.pivot(r,r),s.graphics.drawCircle(r,r,r,"#FFFFFF"),s.pos(t,n),s.r=r,s.ID=null,s.alpha=.4,s.mouseThrough=!0,s.hasSp=a,s.hasSp&&(s.sp=new l["default"](s.x,s.y,s.r/5)),s}return a(e,t),s(e,[{key:"onStartDrag",value:function(t){this.ID=t.touchId,this.moveTo(t.stageX,t.stageY)}},{key:"onStopDrag",value:function(){this.ID=null,this.hasSp&&this.sp.pos(this.x,this.y)}},{key:"moveTo",value:function(t,e){if(this.hasSp){var n=t-this.x,r=e-this.y,o=Math.sqrt(n*n+r*r),i=o>this.r?n*this.r/o:n,a=o>this.r?r*this.r/o:r;this.sp.pos(this.x+i,this.y+a)}}}]),e}(Laya.Sprite);n["default"]=c},{"./DragPoint":4}],21:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),c=t("./Bullet"),h=(r(c),t("./Monster")),f=(r(h),t("./Hero_Bullet_normal")),p=(r(f),t("./Gun_normal")),_=r(p),y=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.v_max=5,t.HP_max=100,t.HP=100,t.armor_max=10,t.armot=10,t.shoot_power=0,t.size(32,48),Laya.Animation.createFrames(t.getURLs("hero/left",4),"hero_left"),Laya.Animation.createFrames(t.getURLs("hero/right",4),"hero_right"),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t}return a(e,t),s(e,[{key:"action",value:function(){var t=the_screen.getVelosity().x,e=the_screen.getVelosity().y,n=this.dl(t,e);this.move_by_dx_dy(t*this.v_max,e*this.v_max),the_screen.getShoot()?this.shoot_power+=1:0!=this.shoot_power&&(this.shoot_power+=1),this.shoot_power>=this.main_gun.first_waiting&&(this.shoot_event(),this.shoot_power=-this.main_gun.second_waiting);var r=this.get_nearest_monster_orientation();this.Object_dl(r)>1e-6?(this.direction_x=r.dx,this.direction_y=r.dy):n>1e-6&&(this.direction_x=t,this.direction_y=e);var o=this.getDir(this.direction_x,this.direction_y,this.pre_dir);if(this.ani.pos(this.x,this.y),o!=this.pre_dir&&(this.ani.play(0,!0,"hero_"+o),this.pre_dir=o),this.direction_x>=0){this.main_gun.scaleX=1;var i=90-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=i}else{this.main_gun.scaleX=-1;var a=270-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=a}}},{key:"shoot_event",value:function(){this.main_gun.shoot(),this.shooting_sound()}},{key:"shooting_sound",value:function(){console.log("播放音效"),Laya.SoundManager.playSound("res/sounds/shooting.mp3",1,new Laya.Handler(this,this.onComplete))}},{key:"get_nearest_monster_orientation",value:function(){var t=1e6,e=null,n=!0,r=!1,o=void 0;try{for(var i,a=Monster_list[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,o=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw o}}return null!==e?{dx:e.mapX-this.mapX,dy:e.mapY-this.mapY}:{dx:0,dy:0}}},{key:"get_harm",value:function(t){this.armor>=t?this.armor-=t:(this.armor=0,t-=this.armor,this.HP-=t)}},{key:"dead",value:function(){this.ani.visible=!1,Laya.stage.removeChild(this.ani)}},{key:"branch_reset",value:function(){this.HP=this.HP_max,this.armor=this.armor_max,Laya.stage.addChild(this.ani),this.ani.pos(this.x,this.y),this.ani.index=1,this.ani.play(0,!0,"hero_right"),this.main_gun=new Laya.Pool.getItemByClass("Gun_normal",_["default"]),this.main_gun.root_reset(),this.alternate_gun=null,this.pre_dir="right"}}]),e}(l["default"]);n["default"]=y},{"./Beings":2,"./Bullet":3,"./Gun_normal":8,"./Hero_Bullet_normal":12,"./Monster":13}]},{},[1]);