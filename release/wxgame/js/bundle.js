var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(){function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return i(n||t)},h,h.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var i=t("./script/Beings"),o=(r(i),t("./script/Bullet")),a=(r(o),t("./script/Hero")),s=(r(a),t("./script/Monster")),u=(r(s),t("./script/Thing")),l=(r(u),t("./script/Hero_Bullet")),h=(r(l),t("./script/Monster_Bullet")),c=(r(h),t("./script/Gate")),f=(r(c),t("./script/Screen")),p=r(f),_=t("./script/DragPoint"),y=(r(_),t("./script/Wheel")),d=(r(y),t("./script/Monster_Bullet_huge")),v=(r(d),t("./script/Monster_Bullet_normal")),g=(r(v),t("./script/Goblin")),b=(r(g),Laya.Browser),m=Laya.WebGL,w=Laya.Stage,O=Laya.Stat;Laya.Handler;Laya.init(b.clientWidth,b.clientHeight,m),Laya.stage.screenMode="horizontal",Laya.stage.scaleMode=w.SCALE_SHOWALL,Laya.stage.bgColor="#232628",window.Monster_list=[],window.Bullet_list=[],window.Wall_list=[],window.Thing_list=[];var P=b.clientWidth,k=b.clientHeight;Laya.stage.alignV=w.ALIGN_MIDDLE,Laya.stage.alignH=w.ALIGN_CENTER,O.show(),window.the_screen=new p["default"](P,k)},{"./script/Beings":2,"./script/Bullet":3,"./script/DragPoint":4,"./script/Gate":5,"./script/Goblin":6,"./script/Hero":12,"./script/Hero_Bullet":13,"./script/Monster":16,"./script/Monster_Bullet":17,"./script/Monster_Bullet_huge":18,"./script/Monster_Bullet_normal":19,"./script/Screen":20,"./script/Thing":23,"./script/Wheel":24}],2:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.HP=1,t.mapX=100,t.mapY=100,t.Type="Beings",t.width=50,t.height=50,t.v_max=5,t.direction_x=1,t.direction_y=1,t.m=.01,t}return o(e,t),a(e,[{key:"root_reset",value:function(){this.visible=!1,Laya.stage.addChild(this),this.pivot(this.width/2,this.height/2),this.zOrder=0,this.ani&&(this.ani.visible=!1,Laya.stage.addChild(this.ani)),this.branch_reset()}},{key:"up_date",value:function(){this.x=this.mapX-the_Hero.mapX+Laya.Browser.clientWidth/2,this.y=this.mapY-the_Hero.mapY+Laya.Browser.clientHeight/2,this.ani&&this.ani.pos(this.x,this.y),this.HP<1?this.dead_action():(this.ani&&(this.ani.visible=!0),this.visible=!0,this.action())}},{key:"dead_action",value:function(){this.visible=!1,Laya.stage.removeChild(this),this.ani&&(this.ani.visible=!1,Laya.stage.removeChild(this.ani)),Laya.Pool.recover(this.Type,this),this.dead()}},{key:"get_harm",value:function(t){this.HP-=t}},{key:"dead",value:function(){}},{key:"action",value:function(){}},{key:"dl",value:function(t,e){return Math.sqrt(t*t+e*e)}},{key:"Object_dl",value:function(t){return Math.sqrt(t.dx*t.dx+t.dy*t.dy)}},{key:"get_distance",value:function(t){var e=this.mapX-t.mapX,n=this.mapY-t.mapY;return this.dl(e,n)}},{key:"get_vector_v",value:function(t,e,n){var r=this.dl(e,n);return r>1e-6&&t>1e-6?{vx:e*t/r,vy:n*t/r}:{vx:0,vy:0}}},{key:"getURLs",value:function(t,e){for(var n=[],r=0;e>r;r+=1)n.push("res/atlas/"+t+r+".png");return n}},{key:"getDir",value:function(t,e,n){return t>0?"right":-t>0?"left":n}},{key:"reachable",value:function(t,e){var n=[];n.push({x:t+this.width/2,y:e+this.height/2}),n.push({x:t,y:e+this.height/2}),n.push({x:t-this.width/2,y:e+this.height/2}),n.push({x:t-this.width/2,y:e}),n.push({x:t-this.width/2,y:e-this.height/2}),n.push({x:t,y:e-this.height/2}),n.push({x:t+this.width/2,y:e-this.height/2}),n.push({x:t+this.width/2,y:e});var r=!0,i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r&=the_screen.getPass(l.x,l.y)}}catch(h){o=!0,a=h}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}},{key:"move_by_dx_dy",value:function(t,e){t>30&&(t=30),e>30&&(e=30),this.reachable(this.mapX+t,this.mapY)?this.mapX+=t:this.reachable(this.mapX+t/2,this.mapY)&&(this.mapX+=t/2),this.reachable(this.mapX,this.mapY+e)?this.mapY+=e:this.reachable(this.mapX,this.mapY+e/2)&&(this.mapY+=e/2)}},{key:"rotate_v",value:function(t,e,n){var r=t*Math.cos(n)-e*Math.sin(n),i=t*Math.sin(n)+e*Math.cos(n);return{x:r,y:i}}},{key:"placeRandomly",value:function(){for(;;){var t=Math.random()*the_screen.mapX_max,e=Math.random()*the_screen.mapY_max;if(this.reachable(t,e)){this.mapX=t,this.mapY=e;break}}}}]),e}(Laya.Sprite);n["default"]=s},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings.js"),l=r(u),h=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.vx=1,t.vy=1,t.v_max=10,t.m=.01,t}return a(e,t),s(e,[{key:"action",value:function(){var t=this.hit_wall(this.vx,this.vy);this.HP-=1,this.move_by_dx_dy(this.vx,this.vy);var e=this.get_attack_list();this.explosion(e),t&&(this.HP=-1)}},{key:"dead",value:function(){Bullet_list.splice(Bullet_list.indexOf(this),1)}},{key:"get_attack_list",value:function(){}},{key:"explosion",value:function(t){if(t.length>0){this.HP=-1;var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.attack(a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}}},{key:"attack",value:function(t){}},{key:"branch_reset",value:function(){Bullet_list.push(this),this.branch_Hero_or_Monster_reset()}},{key:"hit_wall",value:function(t,e){return!this.reachable(this.mapX+t,this.mapY+e)}}]),e}(l["default"]);n["default"]=h},{"./Beings.js":2}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return Laya.stage.addChild(a),a.size(2*o,2*o),a.pivot(o,o),a.graphics.drawCircle(o,o,o,"#FFFF00"),a.pos(t,n),a.alpha=.2,a.r=o,a.mouseThrough=!0,a}return o(e,t),e}(Laya.Sprite);n["default"]=a},{}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Thing"),l=r(u),h=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Gate",t.sentence="去往下一层",t.difficulty=1,t.pivot(16,16),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t.ani.filters=[new Laya.GlowFilter("FFFFAA",5,0,0)],t}return a(e,t),s(e,[{key:"use_it",value:function(){this.HP<1||(this.HP=-1,the_screen.difficulty<this.difficulty&&(the_screen.difficulty=this.difficulty),the_screen.map_change())}},{key:"leaf_reset",value:function(){this.mapX=100,this.mapY=100,this.difficulty=1,this.ani.play(0,!0,"key")}}]),e}(l["default"]);n["default"]=h},{"./Thing":23}],6:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster"),l=r(u),h=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Goblin",t.width=400,t.height=400,t.loadImage("./orz.jpg").scale(.4,.4),t}return a(e,t),s(e,[{key:"skill",value:function(){}},{key:"leaf_reset",value:function(){this.HP=20}}]),e}(l["default"]);n["default"]=h},{"./Monster":16}],7:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Thing"),l=r(u),h=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="God",t.mapX=200,t.mapY=200,t.sentence="冒险家，你需要指引吗？",Laya.Animation.createFrames(t.getURLs("god/down",3),"god_down"),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t}return a(e,t),s(e,[{key:"use_it",value:function(){this.sentence="请选择一扇门，左边是天堂，右边是地狱"}},{key:"dead",value:function(){this.ani.visible=!1,Laya.stage.removeChild(this.ani),Thing_list.splice(Thing_list.indexOf(this),1)}},{key:"leaf_reset",value:function(){this.ani.play(0,!0,"god_down")}}]),e}(l["default"]);n["default"]=h},{"./Thing":23}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),h=t("./Hero_Bullet_normal"),c=r(h),f=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.first_waiting=10,t.second_waiting=100,t.bullet=c["default"],t.bullet_type="Hero_Bullet_normal",t}return a(e,t),s(e,[{key:"action",value:function(){}},{key:"dead",value:function(){}},{key:"branch_reset",value:function(){this.leaf_reset()}}]),e}(l["default"]);n["default"]=f},{"./Beings":2,"./Hero_Bullet_normal":15}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=(r(u),t("./Hero_Bullet_normal")),h=r(l),c=t("./Gun"),f=r(c),p=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Gun_normal",t.first_waiting=1,t.second_waiting=3,t.loadImage("res/guns/gun0.png"),Laya.stage.addChild(t),t.size(64,32),t.pos(Laya.Browser.clientWidth/2,Laya.Browser.clientHeight/2),t.bullet=h["default"],t.bullet_type="Hero_Bullet_normal",t}return a(e,t),s(e,[{key:"shoot",value:function(){var t=Laya.Pool.getItemByClass(this.bullet_type,this.bullet);t.root_reset()}},{key:"leaf_reset",value:function(){this.pivot(8,16),this.visible=!0,this.sentence="杀虫剂"}}]),e}(f["default"]);n["default"]=p},{"./Beings":2,"./Gun":8,"./Hero_Bullet_normal":15}],10:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster"),l=r(u),h=t("./Monster_Bullet_normal"),c=r(h),f=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Gunner",t.size(48,48),t.range=400,t.v_max=3,t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t}return a(e,t),s(e,[{key:"skill",value:function(){var t=Laya.Pool.getItemByClass("Monster_Bullet_normal",c["default"]);t.root_reset(),t.init(this)}},{key:"leaf_reset",value:function(){this.HP=100}}]),e}(l["default"]);n["default"]=f},{"./Monster":16,"./Monster_Bullet_normal":19}],11:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.HP=0,t.armor=0,t.update(),Laya.stage.addChild(t),t.zOrder=1e3,t.size(200,120),t}return o(e,t),a(e,[{key:"update",value:function(){if(this.HP!=the_Hero.HP||this.armor!=the_Hero.armor){Laya.Text;this.HP=the_Hero.HP,this.armor=the_Hero.armor;var t=89/the_Hero.HP_max*the_Hero.HP;this.graphics.drawRect(78,30,89,17,"#555555"),this.graphics.drawRect(78,30,t,17,"#FFFF00");var e=89/the_Hero.armor_max*the_Hero.armor;this.graphics.drawRect(78,79,89,17,"#555555"),this.graphics.drawRect(78,79,e,17,"#FFFF00"),this.loadImage("res/HPWindow/HPWindow.png")}}}]),e}(Laya.Sprite);n["default"]=s},{}],12:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),h=t("./Bullet"),c=(r(h),t("./Monster")),f=(r(c),t("./Hero_Bullet_normal")),p=(r(f),t("./Gun_normal")),_=r(p),y=t("./Shotgun"),d=r(y),v=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Hero",t.v_max=5,t.mapX=150,t.mapY=150,t.HP_max=40,t.HP=40,t.armor_max=40,t.armor=40,t.armor_count=0,t.shoot_power=0,t.size(32,48),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t.nearest_thing=null,t.main_gun=new Laya.Pool.getItemByClass("Gun_normal",_["default"]),t.main_gun.root_reset(),t.alternate_gun=new Laya.Pool.getItemByClass("Shotgun",d["default"]),t.alternate_gun.root_reset(),t}return a(e,t),s(e,[{key:"action",value:function(){var t=the_screen.getChange();if(t&&!this.preChanging){var e=this.main_gun;this.main_gun=this.alternate_gun,this.main_gun.zOrder=this.zOrder+1,this.main_gun.visible=!0,this.alternate_gun=e,this.alternate_gun.visible=!1,this.shoot_power=0,console.log(this.main_gun.sentence),the_screen.setText(this.main_gun.sentence)}this.preChanging=t,this.armor<this.armor_max&&(this.armor_count>=60?(this.armor+=2,this.armor_count=0):this.armor_count+=1);var n=the_screen.getVelosity().x,r=the_screen.getVelosity().y,i=this.dl(n,r);this.move_by_dx_dy(n*this.v_max,r*this.v_max),this.checkitem(),null!==this.nearest_thing&&this.get_distance(this.nearest_thing)<50?(the_screen.setPicture("pick"),the_screen.setText(this.nearest_thing.sentence),the_screen.getShoot()&&this.nearest_thing.use_it(),this.shoot_power<0?this.shoot_power+=1:this.shoot_power=0):(the_screen.setPicture("shoot"),the_screen.setText(),the_screen.getShoot()?this.shoot_power+=1:0!=this.shoot_power&&(this.shoot_power+=1),this.shoot_power>=this.main_gun.first_waiting&&(this.shoot_event(),this.shoot_power=-this.main_gun.second_waiting));var o=this.get_nearest_monster_orientation();this.Object_dl(o)>1e-6?(this.direction_x=o.dx,this.direction_y=o.dy):i>1e-6&&(this.direction_x=n,this.direction_y=r);var a=this.getDir(this.direction_x,this.direction_y,this.pre_dir);if(a!=this.pre_dir&&(this.ani.play(0,!0,"hero_"+a),this.pre_dir=a),this.direction_x>=0){this.main_gun.scaleX=1;var s=90-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=s}else{this.main_gun.scaleX=-1;var u=270-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=u}}},{key:"shoot_event",value:function(){this.main_gun.shoot(),this.shooting_sound()}},{key:"shooting_sound",value:function(){Laya.SoundManager.playSound("res/sounds/shooting.mp3",1,new Laya.Handler(this,this.onComplete))}},{key:"get_nearest_monster_orientation",value:function(){var t=1e6,e=null,n=!0,r=!1,i=void 0;try{for(var o,a=Monster_list[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return null!==e?{dx:e.mapX-this.mapX,dy:e.mapY-this.mapY}:{dx:0,dy:0}}},{key:"checkitem",value:function(){var t=1e6,e=null,n=!0,r=!1,i=void 0;try{for(var o,a=Thing_list[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}null!==e?this.nearest_thing=e:this.nearest_thing=null}},{key:"get_harm",value:function(t){this.armor_count=0,this.HP<1||(this.armor>=t?this.armor-=t:(this.armor=0,t-=this.armor,this.HP-=t))}},{key:"dead",value:function(){this.ani.visible=!1,Laya.stage.removeChild(this.ani)}},{key:"branch_reset",value:function(){this.HP=this.HP_max,this.armor=this.armor_max,this.preChanging=!1,this.shoot_power=0,this.main_gun.zOrder=this.zOrder+1,this.main_gun.visible=!0,this.alternate_gun.visible=!1,this.ani.play(0,!0,"hero_right"),this.pre_dir="right"}}]),e}(l["default"]);n["default"]=v},{"./Beings":2,"./Bullet":3,"./Gun_normal":9,"./Hero_Bullet_normal":15,"./Monster":16,"./Shotgun":22}],13:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Bullet"),l=r(u),h=t("./Monster"),c=(r(h),function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return a(e,t),s(e,[{key:"get_attack_list",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=Monster_list[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.attackable(a)&&t.push(a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t}},{key:"attackable",value:function(t){}},{key:"branch_Hero_or_Monster_reset",value:function(){var t=this.get_vector_v(this.v_max,the_Hero.direction_x,the_Hero.direction_y);this.vx=t.vx,this.vy=t.vy,this.mapX=the_Hero.mapX,this.mapY=the_Hero.mapY,this.leaf_reset()}}]),e}(l["default"]));n["default"]=c},{"./Bullet":3,"./Monster":16}],14:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Hero_Bullet"),l=r(u),h=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.v_max=20,r.Type="Hero_Bullet_normal",r.r=20,r.size(2*r.r,2*r.r),r.graphics.drawCircle(r.r,r.r,r.r,"#BA22AA"),r.filters=[new Laya.GlowFilter("#FBFFAA",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<50}},{key:"attack",value:function(t){t.get_harm(20)}},{key:"leaf_reset",value:function(){this.HP=80}}]),e}(l["default"]);n["default"]=h},{"./Hero_Bullet":13}],15:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Hero_Bullet"),l=r(u),h=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.v_max=10,r.Type="Hero_Bullet_normal",r.r=20,r.size(2*r.r,2*r.r),r.graphics.drawCircle(r.r,r.r,r.r,"#B1F3BB"),r.filters=[new Laya.GlowFilter("#F1FF5F",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<40}},{key:"attack",value:function(t){t.get_harm(20)}},{key:"leaf_reset",value:function(){this.HP=50}}]),e}(l["default"]);n["default"]=h},{"./Hero_Bullet":13}],16:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),h=t("./Gate"),c=r(h),f=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.skill_power=1e3,t.skill_cost=360,t.shooter=!0,t.range=1e3,t}return a(e,t),s(e,[{key:"action",value:function(){this.direction_x=this.get_hero_orientation().dx,this.direction_y=this.get_hero_orientation().dy;var t=this.getDir(this.direction_x,this.direction_y,this.pre_dir);t!=this.pre_dir&&(this.ani.play(0,!0,this.Type+"_"+t),this.pre_dir=t),this.wandering(),this.skill_power<1e3&&(this.skill_power+=1),this.skill_power>=this.skill_cost&&(this.skill_power=0,this.skill()),this.reachable(this.mapX,this.mapY)||console.log("bad thing happened now")}},{key:"force",value:function(t){var e=this.mapX-t.mapX,n=this.mapY-t.mapY,r=0,i=0;return Math.abs(e)>.01&&(r=1/e),Math.abs(n)>.01&&(i=1/n),{fx:r,fy:i}}},{key:"wandering",value:function(){var t={vx:0,vy:0};this.shooter&&(this.get_distance(the_Hero)>this.range/1.5?t=this.get_vector_v(this.v_max,this.direction_x,this.direction_y):this.get_distance(the_Hero)<this.range/2&&(t=this.get_vector_v(this.v_max,-this.direction_x,-this.direction_y)));var e={fx:0,fy:0},n=!0,r=!1,i=void 0;try{for(var o,a=Monster_list[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(this!==s){var u=this.force(s);e.fx+=u.fx,e.fy+=u.fy}}}catch(l){r=!0,i=l}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}Monster_list.length>1&&(e.fx/=Monster_list.length-1,e.fy/=Monster_list.length-1),this.move_by_dx_dy(t.vx+e.fx/this.m,t.vy+e.fx/this.m)}},{key:"dead",value:function(){if(Monster_list.splice(Monster_list.indexOf(this),1),0==Monster_list.length){var t=Laya.Pool.getItemByClass("Gate",c["default"]);t.root_reset()}}},{key:"branch_reset",value:function(){
Monster_list.push(this),this.pre_dir="right",this.skill_power=this.skill_cost*Math.random(),this.ani.play(0,!0,this.Type+"_right"),this.leaf_reset()}},{key:"get_hero_orientation",value:function(){return{dx:the_Hero.mapX-this.mapX,dy:the_Hero.mapY-this.mapY}}}]),e}(l["default"]);n["default"]=f},{"./Beings":2,"./Gate":5}],17:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Bullet"),l=r(u),h=function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return a(e,t),s(e,[{key:"get_attack_list",value:function(){var t=[];return this.attackable(the_Hero)&&t.push(the_Hero),t}},{key:"attackable",value:function(t){}},{key:"attack",value:function(t){}},{key:"branch_Hero_or_Monster_reset",value:function(){this.leaf_reset()}},{key:"init",value:function(t){var e=this.get_vector_v(this.v_max,t.direction_x,t.direction_y);this.vx=e.vx,this.vy=e.vy,this.mapX=t.mapX,this.mapY=t.mapY}}]),e}(l["default"]);n["default"]=h},{"./Bullet":3}],18:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster_Bullet"),l=r(u),h=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.Type="Monster_Bullet_huge",r.vx=t,r.vy=n,r.v_max=20,r.r=20,r.graphics.drawCircle(0,0,r.r,"#F1F200"),r.filters=[new Laya.GlowFilter("#F1F2FF",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<40}},{key:"attack",value:function(t){t.get_harm(10)}},{key:"leaf_reset",value:function(){this.HP=80}}]),e}(l["default"]);n["default"]=h},{"./Monster_Bullet":17}],19:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster_Bullet"),l=r(u),h=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.Type="Monster_Bullet_normal",r.vx=t,r.vy=n,r.r=10,r.graphics.drawCircle(0,0,r.r,"#FFFF00"),r.filters=[new Laya.GlowFilter("#FFFFFF",10,0,0)],r}return a(e,t),s(e,[{key:"attackable",value:function(t){return this.get_distance(t)<20}},{key:"attack",value:function(t){t.get_harm(5)}},{key:"leaf_reset",value:function(){this.HP=40}}]),e}(l["default"]);n["default"]=h},{"./Monster_Bullet":17}],20:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./DragPoint"),l=(r(u),t("./Wheel")),h=r(l),c=t("./hero"),f=r(c),p=t("./Goblin"),_=(r(p),t("./Gunner")),y=r(_),d=t("./Gate"),v=r(d),g=t("./HPWindow"),b=r(g),m=t("./God"),w=r(m),O=t("./Sharpshooter"),P=r(O),k=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return r.width=r.width,r.height=n,Laya.stage.addChild(r),r.size(t,n),r.pos(0,0),r.loadMap(),r.number=0,r.difficulty=1,r.time_count=0,r.time_interval=800,r.mapX_max=1e3,r.mapY_max=1e3,Laya.Animation.createFrames(r.getURLs("hero/left",4),"hero_left"),Laya.Animation.createFrames(r.getURLs("hero/right",4),"hero_right"),Laya.Animation.createFrames(r.getURLs("key/base",4),"key"),Laya.Animation.createFrames(r.getURLs("gunner/left",4),"Gunner_left"),Laya.Animation.createFrames(r.getURLs("gunner/right",4),"Gunner_right"),Laya.Animation.createFrames(r.getURLs("Sharpshooter/left",4),"Sharpshooter_left"),Laya.Animation.createFrames(r.getURLs("Sharpshooter/right",4),"Sharpshooter_right"),r}return a(e,t),s(e,[{key:"loadMap",value:function(){var t=Laya.TiledMap,e=Laya.Rectangle,n=Laya.Handler,r=(Laya.Event,Laya.Browser);this.tiledMap=new t,this.tiledMap.createMap("res/tiledmaps/start.json",new e(0,0,r.width,r.height),n.create(this,this.onLoadedMap))}},{key:"onLoadedMap",value:function(){var t=Laya.Event;Laya.stage.on(t.MOUSE_UP,this,this.onMouseUp),Laya.stage.on(t.MOUSE_MOVE,this,this.onMouseMove),Laya.stage.on(t.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(t.MOUSE_OUT,this,this.onMouseUP),this.whl=new h["default"](this.width/4,3*this.height/4,this.width/15,!0),this.atk=new h["default"](3*this.width/4,3*this.height/4,this.width/15),this.chg=new h["default"](.83*this.width,.55*this.height,this.width/30),this.setPicture("pick"),this.setPicture("shoot"),this.whl.loadImage("res/atlas/wheels/whl.png"),this.chg.loadImage("res/atlas/wheels/chg.png"),this.whl.zOrder=1e3,this.atk.zOrder=1001,this.chg.zOrder=1002,this.whl.sp.zOrder=1003,window.the_Hero=Laya.Pool.getItemByClass("Hero",f["default"]),the_Hero.root_reset(),this.dlg=new Laya.Text,Laya.stage.addChild(this.dlg),this.dlg.pos(0,0),this.dlg.size(200,100),this.dlg.pivot(100,50),this.dlg.fontSize=20,this.dlg.align="center",this.dlg.valign="middle",this.dlg.color="#000000",this.dlg.font="Impact",this.dlg.zOrder=1e3,laya.media.SoundManager.playMusic("res/sounds/BGM.mp3",0),this.paused=!1,Laya.timer.frameLoop(1,this,this.onFrame);var e=Laya.Pool.getItemByClass("Gate",v["default"]);e.root_reset();var n=Laya.Pool.getItemByClass("Gate",v["default"]);n.root_reset(),n.mapX=380,n.mapY=100,n.difficulty=3;var r=Laya.Pool.getItemByClass("God",w["default"]);r.root_reset(),this.HPWindow=new b["default"]}},{key:"generate_monster",value:function(t){for(var e=0;t>e;){var n=Laya.Pool.getItemByClass("Gunner",y["default"]);n.root_reset(),e+=1,n.placeRandomly()}e=0;for(var r=Math.floor(t/5);r>e;){var i=Laya.Pool.getItemByClass("Sharpshooter",P["default"]);i.root_reset(),e+=1,i.placeRandomly()}}},{key:"onFrame",value:function(){if(!this.paused){var t=!0,e=!1,n=void 0;try{for(var r,i=Monster_list[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.up_date()}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}var s=!0,u=!1,l=void 0;try{for(var h,c=Bullet_list[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){var f=h.value;f.up_date()}}catch(a){u=!0,l=a}finally{try{!s&&c["return"]&&c["return"]()}finally{if(u)throw l}}var p=!0,_=!1,y=void 0;try{for(var d,v=Thing_list[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var g=d.value;g.up_date()}}catch(a){_=!0,y=a}finally{try{!p&&v["return"]&&v["return"]()}finally{if(_)throw y}}the_Hero.up_date(),the_Hero.pos(Laya.Browser.clientWidth/2,Laya.Browser.clientHeight/2),this.tiledMap.changeViewPort(the_Hero.mapX-Laya.Browser.clientWidth/2,the_Hero.mapY-Laya.Browser.clientHeight/2,Laya.Browser.clientWidth,Laya.Browser.clientHeight),this.HPWindow.update()}}},{key:"onMouseDown",value:function(t){(this.whl.x-t.stageX)*(this.whl.x-t.stageX)+(this.whl.y-t.stageY)*(this.whl.y-t.stageY)<=this.whl.r*this.whl.r?this.whl.onStartDrag(t):(this.atk.x-t.stageX)*(this.atk.x-t.stageX)+(this.atk.y-t.stageY)*(this.atk.y-t.stageY)<=this.atk.r*this.atk.r?this.atk.onStartDrag(t):(this.chg.x-t.stageX)*(this.chg.x-t.stageX)+(this.chg.y-t.stageY)*(this.chg.y-t.stageY)<=this.chg.r*this.chg.r&&this.chg.onStartDrag(t)}},{key:"onMouseUp",value:function(t){this.whl.ID==t.touchId?this.whl.onStopDrag():this.atk.ID==t.touchId?this.atk.onStopDrag():this.chg.ID==t.touchId&&this.chg.onStopDrag()}},{key:"onMouseMove",value:function(t){this.whl.ID==t.touchId?this.whl.moveTo(t.stageX,t.stageY):this.atk.ID==t.touchId?this.atk.moveTo(t.stageX,t.stageY):this.chg.ID==t.touchId&&this.chg.moveTo(t.stageX,t.stageY)}},{key:"getVelosity",value:function(){return{x:(this.whl.sp.x-this.whl.x)/this.whl.r,y:(this.whl.sp.y-this.whl.y)/this.whl.r}}},{key:"getShoot",value:function(){return null!==this.atk.ID}},{key:"getChange",value:function(){return null!==this.chg.ID}},{key:"getPass",value:function(t,e){var n=this.tiledMap.getLayerByIndex(0).getTileData(Math.floor(t/32),Math.floor(e/32));return void 0!==this.tiledMap._jsonData.tilesets[0].tiles[n-1]?this.tiledMap._jsonData.tilesets[0].tiles[n-1].properties[0].value:!1}},{key:"setPicture",value:function(t){if("shoot"==t&&"shoot"!=this.atk.type){var e=this.atk;e.type="shoot",e.loadImage("res/atlas/wheels/atk1.png")}else if("pick"==t&&"pick"!=this.atk.type){var n=this.atk;n.type="pick",n.loadImage("res/atlas/wheels/atk2.png")}}},{key:"setText",value:function(t,e,n,r,i){void 0===t&&(t=""),void 0===e&&(e="#FFFFFF"),(void 0==n||void 0===r)&&(n=Laya.Browser.clientWidth/2,r=.45*Laya.Browser.clientHeight),void 0===i&&(i=20),this.dlg.changeText(t),this.dlg.color=e,this.dlg.pos(n,r),this.dlg.fontSize=i,this.dlg.alpha=1}},{key:"map_change",value:function(){this.paused=!0;var t=this.number;this.number+=1;var e=Math.floor(t/15),n=t%3,r=(Laya.TiledMap,Laya.Rectangle),i=Laya.Handler,o=(Laya.Event,Laya.Browser),a=!0,s=!1,u=void 0;try{for(var l,h=Monster_list[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var c=l.value;c.HP=-1}}catch(f){s=!0,u=f}finally{try{!a&&h["return"]&&h["return"]()}finally{if(s)throw u}}var p=!0,_=!1,y=void 0;try{for(var d,v=Bullet_list[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var g=d.value;g.HP=-1}}catch(f){_=!0,y=f}finally{try{!p&&v["return"]&&v["return"]()}finally{if(_)throw y}}var b=!0,m=!1,w=void 0;try{for(var O,P=Thing_list[Symbol.iterator]();!(b=(O=P.next()).done);b=!0){var k=O.value;k.HP=-1}}catch(f){m=!0,w=f}finally{try{!b&&P["return"]&&P["return"]()}finally{if(m)throw w}}this.tiledMap.destroy(),this.tiledMap.createMap("res/tiledmaps/"+e+n+".json",new r(0,0,o.width,o.height),i.create(this,this.onLoadedMap2))}},{key:"onLoadedMap2",value:function(){the_Hero.placeRandomly(),the_Hero.root_reset(),this.atk.type=void 0,this.setPicture(),this.tiledMap.changeViewPort(0,0,Laya.Browser.clientWidth,Laya.Browser.clientHeight),this.generate_monster(this.number*this.difficulty),this.paused=!1}},{key:"getURLs",value:function(t,e){for(var n=[],r=0;e>r;r+=1)n.push("res/atlas/"+t+r+".png");return n}}]),e}(Laya.Sprite);n["default"]=k},{"./DragPoint":4,"./Gate":5,"./Goblin":6,"./God":7,"./Gunner":10,"./HPWindow":11,"./Sharpshooter":21,"./Wheel":24,"./hero":25}],21:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Monster"),l=r(u),h=t("./Monster_Bullet_huge"),c=r(h),f=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Sharpshooter",t.size(48,48),t.range=400,t.v_max=3,t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t}return a(e,t),s(e,[{key:"shoot",value:function(){var t=Laya.Pool.getItemByClass(this.bullet_type,this.bullet);t.root_reset()}},{key:"skill",value:function(){var t=Laya.Pool.getItemByClass("Monster_Bullet_huge",c["default"]);t.root_reset(),t.init(this)}},{key:"leaf_reset",value:function(){this.HP=20}}]),e}(l["default"]);n["default"]=f},{"./Monster":16,"./Monster_Bullet_huge":18}],22:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=(r(u),t("./Hero_Bullet_huge")),h=r(l),c=t("./Gun"),f=r(c),p=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Shotgun",t.first_waiting=2,t.second_waiting=50,t.loadImage("res/guns/gun1.png"),Laya.stage.addChild(t),t.size(32,32),t.pos(Laya.Browser.clientWidth/2,Laya.Browser.clientHeight/2),t.bullet=h["default"],t.bullet_type="Hero_Bullet_huge",t}return a(e,t),s(e,[{key:"shoot",value:function(){for(var t=the_Hero.direction_x,e=the_Hero.direction_y,n=.25,r=3,i=-r;r>=i;i++){var o=this.rotate_v(t,e,i*n);the_Hero.direction_x=o.x,the_Hero.direction_y=o.y;var a=Laya.Pool.getItemByClass(this.bullet_type,this.bullet);a.root_reset()}the_Hero.direction_x=t,the_Hero.direction_y=e}},{key:"leaf_reset",value:function(){this.pivot(7,15),this.visible=!0,this.sentence="霰弹枪"}}]),e}(f["default"]);n["default"]=p},{"./Beings":2,"./Gun":8,"./Hero_Bullet_huge":14}],23:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),h=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.sentence="还没有设置句子！",t}return a(e,t),s(e,[{key:"dead",value:function(){Thing_list.splice(Thing_list.indexOf(this),1)}},{key:"use_it",value:function(){}},{key:"branch_reset",value:function(){Thing_list.push(this),this.HP=1,this.leaf_reset()}}]),e}(l["default"]);n["default"]=h},{"./Beings":2}],24:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./DragPoint"),l=r(u),h=function(t){function e(t,n,r,a){i(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));Laya.Sprite,Laya.Event;return Laya.stage.addChild(s),s.size(2*r,2*r),s.pivot(r,r),s.pos(t,n),s.r=r,s.ID=null,s.alpha=.6,s.mouseThrough=!0,s.hasSp=a,s.hasSp&&(s.sp=new l["default"](s.x,s.y,s.r/5)),s}return a(e,t),s(e,[{key:"onStartDrag",value:function(t){this.ID=t.touchId,this.moveTo(t.stageX,t.stageY)}},{key:"onStopDrag",value:function(){this.ID=null,this.hasSp&&this.sp.pos(this.x,this.y)}},{key:"moveTo",value:function(t,e){if(this.hasSp){var n=t-this.x,r=e-this.y,i=Math.sqrt(n*n+r*r),o=i>this.r?n*this.r/i:n,a=i>this.r?r*this.r/i:r;this.sp.pos(this.x+o,this.y+a)}}}]),e}(Laya.Sprite);n["default"]=h},{"./DragPoint":4}],25:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Beings"),l=r(u),h=t("./Bullet"),c=(r(h),t("./Monster")),f=(r(c),t("./Hero_Bullet_normal")),p=(r(f),t("./Gun_normal")),_=r(p),y=t("./Shotgun"),d=r(y),v=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Type="Hero",t.v_max=5,t.mapX=150,t.mapY=150,t.HP_max=40,t.HP=40,t.armor_max=40,t.armor=40,t.armor_count=0,t.shoot_power=0,t.size(32,48),t.ani=new Laya.Animation,t.ani.interval=100,t.ani.pivot(t.width/2,t.height/2),t.nearest_thing=null,t.main_gun=new Laya.Pool.getItemByClass("Gun_normal",_["default"]),t.main_gun.root_reset(),t.alternate_gun=new Laya.Pool.getItemByClass("Shotgun",d["default"]),t.alternate_gun.root_reset(),t}return a(e,t),s(e,[{key:"action",value:function(){var t=the_screen.getChange();if(t&&!this.preChanging){var e=this.main_gun;this.main_gun=this.alternate_gun,this.main_gun.zOrder=this.zOrder+1,this.main_gun.visible=!0,this.alternate_gun=e,this.alternate_gun.visible=!1,this.shoot_power=0,console.log(this.main_gun.sentence),the_screen.setText(this.main_gun.sentence)}this.preChanging=t,this.armor<this.armor_max&&(this.armor_count>=60?(this.armor+=2,this.armor_count=0):this.armor_count+=1);var n=the_screen.getVelosity().x,r=the_screen.getVelosity().y,i=this.dl(n,r);this.move_by_dx_dy(n*this.v_max,r*this.v_max),this.checkitem(),null!==this.nearest_thing&&this.get_distance(this.nearest_thing)<50?(the_screen.setPicture("pick"),the_screen.setText(this.nearest_thing.sentence),the_screen.getShoot()&&this.nearest_thing.use_it(),this.shoot_power<0?this.shoot_power+=1:this.shoot_power=0):(the_screen.setPicture("shoot"),the_screen.setText(),the_screen.getShoot()?this.shoot_power+=1:0!=this.shoot_power&&(this.shoot_power+=1),this.shoot_power>=this.main_gun.first_waiting&&(this.shoot_event(),this.shoot_power=-this.main_gun.second_waiting));var o=this.get_nearest_monster_orientation();this.Object_dl(o)>1e-6?(this.direction_x=o.dx,this.direction_y=o.dy):i>1e-6&&(this.direction_x=n,this.direction_y=r);var a=this.getDir(this.direction_x,this.direction_y,this.pre_dir);if(a!=this.pre_dir&&(this.ani.play(0,!0,"hero_"+a),this.pre_dir=a),this.direction_x>=0){this.main_gun.scaleX=1;var s=90-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=s}else{this.main_gun.scaleX=-1;var u=270-Math.atan2(this.direction_x,this.direction_y)/Math.PI*180;this.main_gun.rotation=u}}},{key:"shoot_event",value:function(){this.main_gun.shoot(),this.shooting_sound()}},{key:"shooting_sound",value:function(){Laya.SoundManager.playSound("res/sounds/shooting.mp3",1,new Laya.Handler(this,this.onComplete))}},{key:"get_nearest_monster_orientation",value:function(){var t=1e6,e=null,n=!0,r=!1,i=void 0;try{for(var o,a=Monster_list[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return null!==e?{dx:e.mapX-this.mapX,dy:e.mapY-this.mapY}:{dx:0,dy:0}}},{key:"checkitem",value:function(){var t=1e6,e=null,n=!0,r=!1,i=void 0;try{for(var o,a=Thing_list[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.get_distance(s)<t&&(t=this.get_distance(s),e=s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}null!==e?this.nearest_thing=e:this.nearest_thing=null}},{key:"get_harm",value:function(t){this.armor_count=0,this.HP<1||(this.armor>=t?this.armor-=t:(this.armor=0,t-=this.armor,this.HP-=t))}},{key:"dead",value:function(){this.ani.visible=!1,Laya.stage.removeChild(this.ani)}},{key:"branch_reset",value:function(){this.HP=this.HP_max,this.armor=this.armor_max,this.preChanging=!1,this.shoot_power=0,this.main_gun.zOrder=this.zOrder+1,this.main_gun.visible=!0,this.alternate_gun.visible=!1,this.ani.play(0,!0,"hero_right"),this.pre_dir="right"}}]),e}(l["default"]);n["default"]=v},{"./Beings":2,"./Bullet":3,"./Gun_normal":9,"./Hero_Bullet_normal":15,"./Monster":16,"./Shotgun":22}]},{},[1]);